# VERSIONING

本システムにおけるバージョニングの仕様を以下に示す。

## Assembly バージョン

Assembly バージョンは .NET のコンパイルで生成されるアセンブリのバージョン情報のことを示し、アプリケーションの動作へ影響するものではないが、アプリケーションの修正に合わせ都度バージョンを更新することとする。
アセンブリのバージョンはすべてのアセンブリで統一するために `~/src/Directory.Build.props` で管理し、[セマンティックバージョニング](https://semver.org/lang/ja/)の仕様に準拠すること。例として、バージョンが 1.0.0 の状態で軽微なバグフィックスを行った場合はバージョンを 1.0.1 へ更新する。次に、バージョンが 1.0.1 の状態で後方互換性のある機能性の追加を行った場合はバージョンを 1.1.0 へ更新する。また、バージョンが 1.1.0 の状態で後方互換性のない修正を行った場合はバージョンを 2.0.0 へ更新する。

## API バージョン

API はリクエストに API バージョンを要求するように設定し、フロントエンドにおいて API バージョンの更新を検知できるようにする。
API で後方互換性のある修正を行う場合は、フロントエンドに影響がないため API バージョンの更新を行わないこと。逆に、後方互換性のない修正を行う場合は、API バージョンを更新しフロントエンドでアプリケーションの更新を検知できるようにする。
API バージョンは `Applications.WebHost.Core.Mvc.AppApiVersion` 列挙体で管理し、既定の API バージョン以外のアクションには、`Applications.WebHost.Core.Mvc.AppApiVersionAttribute` 属性で API バージョンを指定する。

## SPA バージョン

SPA は初回のリクエストでリソースを全て取得する特性により、新しいバージョンをデプロイしても更新が行われない。デプロイされた最新バージョンを反映させるために、ルーティング時に SPA のバージョンを検証し、自動でページの再読み込みを行わせることとする。
SPA バージョンは `Applications.WebHost.Core.Mvc.SpaApiVersion` 列挙体で管理し、フロントエンドは `Applications.WebHost.Features.Versioning.Controllers.Get()` アクションから取得できる情報をもとにバージョンの検証を行う。
